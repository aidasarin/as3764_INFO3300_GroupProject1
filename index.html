<html>
<head>
  <title>Project 1 - Female Age Density</title>
  <script src="https://d3js.org/d3.v6.min.js"></script>

  <style>
    .gridlines line {
      stroke: #bbb;
    }

    .gridlines .domain {
      stroke: none;
    }

    .legend span {
    margin-right: 10px;
    }

    svg {
      display: flex;
      justify-content: center;
      align-items: center;
      margin-left: 10%
    }

    div.projtitle {
      width: 100%;
      height: 50px;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: darkgrey;

    }

    text.projtitle {
      font-family:sans-serif;
      color: white;
    }

    div.graphtitle{
      width: 100%;
      height: 50px;
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #FFC5D0;
    }

    text.graphtitle{
      font-family:sans-serif;
      color: white;
    }

  </style>


</head>
<body>

  <div class = "projtitle"> <text class = "projtitle"> The Bachelor Contestants </text> </div>
  <div class = "projtitle"> <text class = "projtitle"> CS 3300 Project 1 </text> </div>

  <div class = "graphtitle"> <text class = "graphtitle"> Contestant's Age Density Plots: </text> </div>
  <svg id="ageplot" height="525" width="900" style="margin-top:50px" >
  </svg>

  <script>

  const svg = d3.select("svg#ageplot");
  const width = svg.attr("width");
  const height = svg.attr("height");
  const margin = {top: 10, right: 10, bottom: 75, left: 100};
  const chartWidth = width - margin.left - margin.right;
  const chartHeight = height - margin.top - margin.bottom;

  let annotations = svg.append("g").attr("id","annotations");
  let chartArea = svg.append("g").attr("id","points")
                  .attr("transform",`translate(${margin.left},${margin.top})`);
// axis labels:

svg.append("text")
    .attr("class", "y label")
    .attr("text-anchor", "middle")
    .attr("y", 50)
    .attr("x", -chartHeight/2)
    .attr("transform", "rotate(-90)")
    .text("Number of Contestants");

svg.append("text")
    .attr("class", "x label")
    .attr("text-anchor", "middle")
    .attr("y", chartHeight + margin.bottom)
    .attr("x", chartWidth/2 + 100)
    .text("Age (years)");
//title:
  chartArea.append("text")
          .attr("x", (width / 2))
          .attr("y", (margin.top / 2))
          .attr("text-anchor", "middle")
          .style("font-size", "16px")
          .style("text-decoration", "underline")
          .text("Bachelor Contestants Age");

  d3.csv("Project-1-Dataset-Bachelor.csv", d3.autoType).then( (data) => {

    data = data.filter( (d) => {return d['Age'] >= 20;}  );


 // x axis:
    const ageExtent = d3.extent(data, d => d['Age'] );

    const ageScale = d3.scaleLinear()
                      .domain([ageExtent[0] - 1, ageExtent[1] + 1 ])
                      .range([0, chartWidth]);

    let bottomAxis = d3.axisBottom(ageScale)
                        .ticks(17);

    let bottomGridlines = d3.axisBottom(ageScale)
                            .tickSize(-chartHeight-10)
                            .tickFormat("")
                            .ticks(17);

    annotations.append("g")
              .attr("class", "x axis")
              .attr("transform",`translate(${margin.left},${chartHeight+margin.top+10})`)
              .call(bottomAxis);
    annotations.append("g")
              .attr("class", "x gridlines")
              .attr("transform",`translate(${margin.left},${chartHeight+margin.top+10})`)
              .call(bottomGridlines);

//set parameters for the Histogram:
    var histogram = d3.histogram()
                      .value(function(d) {return d.Age;})
                      .domain(ageScale.domain())
                      .thresholds(ageScale.ticks(17));

    var bins = histogram(data);

// y axis:
    const contestantScale = d3.scaleLinear()
                              .domain([0, d3.max(bins, function(d) {return d.length;})]) // this needs to be changed
                              .range([chartHeight, 0]);

    let leftAxis = d3.axisLeft(contestantScale)

    annotations.append("g")
              .attr("class", "y axis")
              .attr("transform",`translate(${margin.left-10},${margin.top})`)
              .call(leftAxis);




 // add a line:

    var lineGen = d3.line()
                  .x( d => ageScale((d.x0) ))
                  .y( d => contestantScale(d.length) )
                  .curve(d3.curveMonotoneX);

    chartArea.append("path")
              .datum(bins)
              .attr("class", "line")
              .attr("fill", "#FFC5D0")
              .attr("opacity", 0.6)
              .attr("stroke", "#FFC5D0")
              .attr("stroke-width", 3)
              .attr("d", lineGen);


/////// FINAL FOUR ONLY ////////////

// add in column for winner:
  data.forEach( (d, i) => {
      if (d["ElimWeek"] === null){
        d["ElimWeek"] = 'W';
        d["Winner"] = 1;
      }
      else { d["Winner"] = 0;}
    });

// add in column final four:

  data.forEach( (d, i) => {
      if (d["Season"] === 1 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 4)) { d['finalFour'] = 1;}
      else if (d["Season"] === 2 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 5)) { d['finalFour'] = 1;}
      else if (d["Season"] === 5 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 5)) { d['finalFour'] = 1;}
      else if (d["Season"] === 9 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 5)) { d['finalFour'] = 1;}
      else if (d["Season"] === 10 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 6)) { d['finalFour'] = 1;}
      else if (d["Season"] === 11 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 6)) { d['finalFour'] = 1;}
      else if (d["Season"] === 12 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 6)) { d['finalFour'] = 1;}
      else if (d["Season"] === 13 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 6)) { d['finalFour'] = 1;}
      else if (d["Season"] === 14 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 6)) { d['finalFour'] = 1;}
      else if (d["Season"] === 15 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 8)) { d['finalFour'] = 1;}
      else if (d["Season"] === 16 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 8)) { d['finalFour'] = 1;}
      else if (d["Season"] === 17 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 8)) { d['finalFour'] = 1;}
      else if (d["Season"] === 18 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 8)) { d['finalFour'] = 1;}
      else if (d["Season"] === 19 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 8)) { d['finalFour'] = 1;}
      else if (d["Season"] === 20 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 8)) { d['finalFour'] = 1;}
      else if (d["Season"] === 21 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 8)) { d['finalFour'] = 1;}
      else {d['finalFour'] = 0;}
    });

    dataff = data.filter( (d) => {return d['Age'] >= 20   &&  d['finalFour'] === 1 ;}  );

    var binsff = histogram(dataff);
    chartArea.append("path")
              .datum(binsff)
              .attr("class", "line")
              .attr("fill", "#FB6090")
              .attr("opacity", 0.7)
              .attr("stroke", "#FB6090")
              .attr("stroke-width", 3)
              .attr("d", lineGen);



/////// Winners ONLY ////////////
  dataW = data.filter( (d) => {return d['Age'] >= 20   &&  d['ElimWeek'] === "W" ;}  );

  var binsW = histogram(dataW);
  chartArea.append("path")
          .datum(binsW)
          .attr("class", "line")
          .attr("fill", "#821D30")
          .attr("opacity", 1.0)
          .attr("stroke", "#821D30")
          .attr("stroke-width", 3)
          .attr("d", lineGen);

/// Add legend ////
  const legend = chartArea.append("g").attr("class", "legend").attr("transform","translate(10,10)");
  legend.append("rect").attr("x", 580).attr("y", 10).attr("width", 145).attr("height", 100).attr("fill", "white").attr("stroke", "black");
  legend.append("circle").attr("cx",600).attr("cy",30).attr("r", 6).style("fill", "#FFC5D0").attr("opacity", 0.6)
  legend.append("circle").attr("cx",600).attr("cy",60).attr("r", 6).style("fill", "#FB6090").attr("opacity", 0.7)
  legend.append("circle").attr("cx",600).attr("cy",90).attr("r", 6).style("fill", "#821D30").attr("opacity", 1.0)
  legend.append("text").attr("x", 620).attr("y", 30).text("All Contestants").style("font-size", "15px").attr("alignment-baseline","middle")
  legend.append("text").attr("x", 620).attr("y", 60).text("Final Four").style("font-size", "15px").attr("alignment-baseline","middle")
  legend.append("text").attr("x", 620).attr("y", 90).text("Winners").style("font-size", "15px").attr("alignment-baseline","middle")

//// Add average markers //////

      //average female contestant age:
      let sumAge = 0
      let totContest = 0
      data.forEach( (d, i) => {
      sumAge += d["Age"];
      totContest += 1;
        });
      let avgAge = Math.floor(sumAge/totContest);




      // average winner age:
      sumAge = 0
      totContest = 0
      dataW.forEach( (d, i) => {
      sumAge += d["Age"];
      totContest += 1;
        });
      let avgWAge = Math.floor(sumAge/totContest);


      const avgAgeLabel = chartArea.append("g").attr("class", "label");
      avgAgeLabel.append("rect")
            .attr("x", ageScale(avgAge))
            .attr("y", 20)
            .attr("width", 160)
            .attr("height", 60)
            .attr("fill", "white")
            .attr("opacity", 0.7)
            .attr("stroke", "darkgrey")
            .attr("stroke-width", 3);
      avgAgeLabel.append("text")
            .attr("x", ageScale(avgAge) + 4)
            .attr("y", 40)
            .text("Average Age of ")
            .style("font-size", "15px")
            .attr("alignment-baseline","middle");
      avgAgeLabel.append("text")
            .attr("x", ageScale(avgAge) + 4)
            .attr("y", 60)
            .text("Female Contestants: 26")
            .style("font-size", "15px")
            .attr("alignment-baseline","middle");
      avgAgeLabel.append("line")
            .style("stroke", "darkgrey")
            .style("stroke-width", 3)
            .attr("x1", ageScale(avgAge))
            .attr("x2", ageScale(avgAge))
            .attr("y1", 20)
            .attr("y2", chartHeight);

      const wAgeLabel = chartArea.append("g").attr("class", "label");
      wAgeLabel.append("rect")
                .attr("x", ageScale(avgWAge) - 140)
                .attr("y", 200)
                .attr("width", 140)
                .attr("height", 60)
                .attr("fill", "white")
                .attr("opacity", 0.7)
                .attr("stroke", "darkgrey")
                  .attr("stroke-width", 3);
      wAgeLabel.append("text")
                .attr("x", ageScale(avgWAge) - 136)
                .attr("y", 220)
                .text("Average Age of ")
                .style("font-size", "15px")
                .attr("alignment-baseline","middle");
      wAgeLabel.append("text")
                .attr("x", ageScale(avgWAge) - 136)
                .attr("y", 240)
                .text("Female Winners: 25")
                .style("font-size", "15px")
                .attr("alignment-baseline","middle");
      wAgeLabel.append("line")
                .style("stroke", "darkgrey")
                .style("stroke-width", 3)
                .attr("x1", ageScale(avgWAge))
                .attr("x2", ageScale(avgWAge))
                .attr("y1", 200)
                .attr("y2", chartHeight)


/// add in avg age of bachelor
    d3.csv("bachelors.csv", d3.autoType).then( (data2) =>{
      sumBAge = 0
      totBach = 0
      data2.forEach( (d, i) => {
        sumBAge += d["Age"];
        totBach += 1;
        });
      let avgBachAge = Math.floor(sumBAge/totBach);

      const bAgeLabel = chartArea.append("g").attr("class", "label");
      bAgeLabel.append("rect")
                .attr("x", ageScale(avgBachAge) - 110)
                .attr("y", 170)
                .attr("width", 110)
                .attr("height", 60)
                .attr("fill", "white")
                .attr("opacity", 0.7)
                .attr("stroke", "darkgrey")
                .attr("stroke-width", 3);
      bAgeLabel.append("text")
                .attr("x", ageScale(avgBachAge) - 105)
                .attr("y", 190)
                .text("Average Age of ")
                .style("font-size", "15px")
                .attr("alignment-baseline","middle");
      bAgeLabel.append("text")
                .attr("x", ageScale(avgBachAge) - 105)
                .attr("y", 210)
                .text("the Bachelor: 31")
                .style("font-size", "15px")
                .attr("alignment-baseline","middle");
      bAgeLabel.append("line")
                .style("stroke", "darkgrey")
                .style("stroke-width", 3)
                .attr("x1", ageScale(avgBachAge))
                .attr("x2", ageScale(avgBachAge))
                .attr("y1", 170)
                .attr("y2", chartHeight)
    });



  }); // end promise



  </script>


  <svg id="ageplot2" height="525" width="900" style="margin-top:50px" >
  </svg>
  <script>

  const svg2 = d3.select("svg#ageplot2");
  const width2 = svg2.attr("width");
  const height2 = svg2.attr("height");
  const margin2 = {top: 10, right: 10, bottom: 75, left: 100};
  const chartWidth2 = width2 - margin2.left - margin2.right;
  const chartHeight2 = height2 - margin2.top - margin2.bottom;

  let annotations2 = svg2.append("g").attr("id","annotations");
  let chartArea2 = svg2.append("g").attr("id","points")
                  .attr("transform",`translate(${margin.left},${margin.top})`);

// // add axis lables:
svg2.append("text")
    .attr("class", "y label")
    .attr("text-anchor", "middle")
    .attr("y", 50)
    .attr("x", -chartHeight/2)
    .attr("transform", "rotate(-90)")
    .text("Number of Contestants");

svg2.append("text")
    .attr("class", "x label")
    .attr("text-anchor", "middle")
    .attr("y", chartHeight + margin.bottom)
    .attr("x", chartWidth/2 + 100)
    .text("Age (years)");

// create title:
  chartArea2.append("text")
      .attr("x", (width / 2))
      .attr("y", (margin.top / 2))
      .attr("text-anchor", "middle")
      .style("font-size", "16px")
      .style("text-decoration", "underline")
      .text("Bachelorette Contestant Age");

  d3.csv("Project-1-Dataset-Bachelorette.csv", d3.autoType).then( (data) => {

    data = data.filter( (d) => {return d['Age'] >= 20;}  );


 // x axis:
    const ageExtent = d3.extent(data, d => d['Age'] );

    const ageScale = d3.scaleLinear()
                      .domain([ageExtent[0] - 1, ageExtent[1] + 1 ])
                      .range([0, chartWidth]);

    let bottomAxis = d3.axisBottom(ageScale)
                        .ticks(21);

    let bottomGridlines = d3.axisBottom(ageScale)
                            .tickSize(-chartHeight-10)
                            .tickFormat("")
                            .ticks(21);

    annotations2.append("g")
              .attr("class", "x axis")
              .attr("transform",`translate(${margin.left},${chartHeight+margin.top+10})`)
              .call(bottomAxis);
    annotations2.append("g")
              .attr("class", "x gridlines")
              .attr("transform",`translate(${margin.left},${chartHeight+margin.top+10})`)
              .call(bottomGridlines);

//set parameters for the Histogram:
    var histogram = d3.histogram()
                      .value(function(d) {return d.Age;})
                      .domain(ageScale.domain())
                      .thresholds(ageScale.ticks(21));

    var bins = histogram(data);

// y axis:
    const contestantScale = d3.scaleLinear()
                              .domain([0, d3.max(bins, function(d) {return d.length;})]) // this needs to be changed
                              .range([chartHeight, 0]);

    let leftAxis = d3.axisLeft(contestantScale)

    annotations2.append("g")
              .attr("class", "y axis")
              .attr("transform",`translate(${margin.left-10},${margin.top})`)
              .call(leftAxis);





 // add a line:

    var lineGen = d3.line()
                  .x( d => ageScale((d.x0) ))
                  .y( d => contestantScale(d.length) )
                  .curve(d3.curveMonotoneX);

    chartArea2.append("path")
              .datum(bins)
              .attr("class", "line")
              .attr("fill", "#B1D4E0")
              .attr("opacity", 0.7)
              .attr("stroke", "#B1D4E0")
              .attr("stroke-width", 3)
              .attr("d", lineGen);


/////// FINAL FOUR ONLY ////////////

// add in column for winner:
  data.forEach( (d, i) => {
      if (d["ElimWeek"] === null){
        d["ElimWeek"] = 'W';
        d["Winner"] = 1;
      }
      else { d["Winner"] = 0;}
    });

// add in column final four:


let seasonarr = [];
data.forEach( (d, i) => {
  if (seasonarr.includes(d["Season"]) === false){
    seasonarr.push(d["Season"]);
  }
});
  data.forEach( (d, i) => {
      if (d["Season"] === 1 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 4)) { d['finalFour'] = 1;}
      else if (d["Season"] === 2 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 5)) { d['finalFour'] = 1;}
      else if (d["Season"] === 4 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 6)) { d['finalFour'] = 1;}
      else if (d["Season"] === 5 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 8)) { d['finalFour'] = 1;}
      else if (d["Season"] === 6 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 8)) { d['finalFour'] = 1;}
      else if (d["Season"] === 7 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 8)) { d['finalFour'] = 1;}
      else if (d["Season"] === 8 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 8)) { d['finalFour'] = 1;}
      else if (d["Season"] === 9 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 8)) { d['finalFour'] = 1;}
      else if (d["Season"] === 10 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 8)) { d['finalFour'] = 1;}
      else if (d["Season"] === 11 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 7)) { d['finalFour'] = 1;}
      else if (d["Season"] === 12 && (d["ElimWeek"] === "W" || d["ElimWeek"] >= 8)) { d['finalFour'] = 1;}
      else {d['finalFour'] = 0;}
    });

    dataff = data.filter( (d) => {return d['Age'] >= 20   &&  d['finalFour'] === 1 ;}  );

    var binsff = histogram(dataff);
    chartArea2.append("path")
              .datum(binsff)
              .attr("class", "line")
              .attr("fill", "#2E8BC0")
              .attr("opacity", 0.7)
              .attr("stroke", "#2E8BC0")
              .attr("stroke-width", 3)
              .attr("d", lineGen);



/////// Winners ONLY ////////////
  dataW = data.filter( (d) => {return d['Age'] >= 20   &&  d['ElimWeek'] === "W" ;}  );

  var binsW = histogram(dataW);
  chartArea2.append("path")
          .datum(binsW)
          .attr("class", "line")
          .attr("fill", "#0C2D48")
          .attr("opacity", 1.0)
          .attr("stroke", "#0C2D48")
          .attr("stroke-width", 3)
          .attr("d", lineGen);

/// Add legend ////
  const legend2 = chartArea2.append("g").attr("class", "legend").attr("transform","translate(10,10)");
  legend2.append("rect").attr("x", 580).attr("y", 10).attr("width", 145).attr("height", 100).attr("fill", "white").attr("stroke", "black");
  legend2.append("circle").attr("cx",600).attr("cy",30).attr("r", 6).style("fill", "#B1D4E0").attr("opacity", 0.7)
  legend2.append("circle").attr("cx",600).attr("cy",60).attr("r", 6).style("fill", "#2E8BC0").attr("opacity", 0.7)
  legend2.append("circle").attr("cx",600).attr("cy",90).attr("r", 6).style("fill", "#0C2D48").attr("opacity", 1.0)
  legend2.append("text").attr("x", 620).attr("y", 30).text("All Contestants").style("font-size", "15px").attr("alignment-baseline","middle")
  legend2.append("text").attr("x", 620).attr("y", 60).text("Final Four").style("font-size", "15px").attr("alignment-baseline","middle")
  legend2.append("text").attr("x", 620).attr("y", 90).text("Winners").style("font-size", "15px").attr("alignment-baseline","middle")

//// Add average markers //////

      //average female contestant age:
      let sumAge = 0
      let totContest = 0
      data.forEach( (d, i) => {
      sumAge += d["Age"];
      totContest += 1;
        });
      let avgAge = Math.floor(sumAge/totContest);




      // average winner age:
      sumAge = 0
      totContest = 0
      dataW.forEach( (d, i) => {
      sumAge += d["Age"];
      totContest += 1;
        });
      let avgWAge = Math.floor(sumAge/totContest);



      const avgAgeLabel2 = chartArea2.append("g").attr("class", "label");
      avgAgeLabel2.append("rect")
            .attr("x", ageScale(avgAge))
            .attr("y", 20)
            .attr("width", 140)
            .attr("height", 60)
            .attr("fill", "white")
            .attr("opacity", 0.7)
            .attr("stroke", "darkgrey")
            .attr("stroke-width", 3);
      avgAgeLabel2.append("text")
            .attr("x", ageScale(avgAge) + 4)
            .attr("y", 40)
            .text("Average Age of ")
            .style("font-size", "15px")
            .attr("alignment-baseline","middle");
      avgAgeLabel2.append("text")
            .attr("x", ageScale(avgAge) + 4)
            .attr("y", 60)
            .text("Male Contestants: 29")
            .style("font-size", "15px")
            .attr("alignment-baseline","middle");
      avgAgeLabel2.append("line")
            .style("stroke", "darkgrey")
            .style("stroke-width", 3)
            .attr("x1", ageScale(avgAge))
            .attr("x2", ageScale(avgAge))
            .attr("y1", 20)
            .attr("y2", chartHeight);

      const wAgeLabel2 = chartArea2.append("g").attr("class", "label");
      wAgeLabel2.append("rect")
                .attr("x", ageScale(avgWAge) - 120)
                .attr("y", 200)
                .attr("width", 120)
                .attr("height", 60)
                .attr("fill", "white")
                .attr("opacity", 0.7)
                .attr("stroke", "darkgrey")
                  .attr("stroke-width", 3);
      wAgeLabel2.append("text")
                .attr("x", ageScale(avgWAge) - 116)
                .attr("y", 220)
                .text("Average Age of ")
                .style("font-size", "15px")
                .attr("alignment-baseline","middle");
      wAgeLabel2.append("text")
                .attr("x", ageScale(avgWAge) - 116)
                .attr("y", 240)
                .text("Male Winners: 28")
                .style("font-size", "15px")
                .attr("alignment-baseline","middle");
      wAgeLabel2.append("line")
                .style("stroke", "darkgrey")
                .style("stroke-width", 3)
                .attr("x1", ageScale(avgWAge))
                .attr("x2", ageScale(avgWAge))
                .attr("y1", 200)
                .attr("y2", chartHeight)




/// add in avg age of bachelor
      d3.csv("bachelorettes.csv", d3.autoType).then( (data2) =>{


          sumBAge = 0
          totBach = 0
          data2.forEach( (d, i) => {
              if (d["Name"] === "Meredith Phillips") {d["Age"] = 30}
              else if (d["Name"] === "Jennifer \"Jen\" Schefft") {d["Age"] = 30}
              else if (d["Name"] === "DeAnna Pappas") {d["Age"] = 27}
              else if (d["Name"] === "Ashley Hebert") {d["Age"] = 26}
              else if (d["Name"] === "Emily Maynard") {d["Age"] = 26}
              sumBAge += d["Age"];
              totBach += 1;
          });
          let avgBachAge = Math.floor(sumBAge/totBach);


          const bAgeLabel2 = chartArea2.append("g").attr("class", "label");
          bAgeLabel2.append("rect")
                    .attr("x", ageScale(avgBachAge) - 120)
                    .attr("y", 300)
                    .attr("width", 120)
                    .attr("height", 60)
                    .attr("fill", "white")
                    .attr("opacity", 0.7)
                    .attr("stroke", "darkgrey")
                      .attr("stroke-width", 3);
          bAgeLabel2.append("text")
                    .attr("x", ageScale(avgBachAge) - 116)
                    .attr("y", 320)
                    .text("Average Age of ")
                    .style("font-size", "15px")
                    .attr("alignment-baseline","middle");
          bAgeLabel2.append("text")
                    .attr("x", ageScale(avgBachAge) - 116)
                    .attr("y", 340)
                    .text("Bachelorettes: 27")
                    .style("font-size", "15px")
                    .attr("alignment-baseline","middle");
          bAgeLabel2.append("line")
                    .style("stroke", "darkgrey")
                    .style("stroke-width", 3)
                    .attr("x1", ageScale(avgBachAge))
                    .attr("x2", ageScale(avgBachAge))
                    .attr("y1", 300)
                    .attr("y2", chartHeight)
                    });


  }); // end promise



  </script>
<div class = "projtitle"> <text class = "projtitle">We found that on average, both the bachelors and the bachelorettes tend to choose winners younger than the average contestant. </text> </div>
  <div class = "graphtitle"> <text class = "graphtitle"> Contestants per Season </text> </div>
  <div class = "graphtitle"> <text class = "graphtitle"> Minorities and Caucasion </text> </div>


  <svg id="barchart" height="550" width="900"></svg>
  <br></br>
  <svg id="barchart2" height="550" width="900"></svg>

  <script>

  //creating a bar graph for FEMALE contestants for the bachelor


  //creating space for second graph
  const svg4 = d3.select("svg#barchart2");
  const width4 = svg4.attr("width");
  const height4 = svg4.attr("height");
  const margin4 = {top: 10, right: 10, bottom: 70, left: 50};
  const chartWidth4 = width4 - margin4.left - margin4.right;
  const chartHeight4 = height4 - margin4.top - margin4.bottom;

  let annotations4 = svg4.append("g").attr("id","annotations");
  let chartArea4 = svg4.append("g").attr("id","points")
                    .attr("transform",`translate(${margin4.left},${margin4.top})`);

  d3.csv("count_data_bachelor.csv").then( data => { console.log("data", data);

  //making sure each value is a number and not a string
  data.forEach((d, i) => {
    d['id'] = Number(d['id']);
    d['season'] = Number(d['season']);
    d['totalcast'] = Number(d['totalcast']);
    d['minority'] = Number(d['minority']);
    d['white'] = Number(d['white']);
    d['year'] = Number(d['year']);
  });

  console.log(data)

  //creating scales
  const countScale = d3.scaleLinear().domain([0,45]).range([chartHeight2, 0]);

  const years = d3.map(data, d => d.year)
    console.log(years)
  const yearScale = d3.scaleBand().domain(years).range([0, chartWidth2])
                           .padding(0.3);

  //axis and gridlines
  let leftAxis = d3.axisLeft(countScale);
  let leftGridlines = d3.axisLeft(countScale)
                           .tickSize(-chartWidth2-10)
                           .tickFormat("")
  annotations4.append("g")
            .attr("class", "y axis")
            .attr("transform",`translate(${margin4.left-10},${margin4.top})`)
            .call(leftAxis)
  annotations4.append("g")
            .attr("class", "y gridlines")
            .attr("transform",`translate(${margin4.left-10},${margin4.top})`)
            .call(leftGridlines);
  let bottomAxis = d3.axisBottom(yearScale)

  annotations4.append("g")
              .attr("class", "x axis")
              .attr("transform",`translate(${margin4.left},${chartHeight2+margin4.top+10})`)
              .call(bottomAxis);

  //axis labels
  chartArea4.append("text").attr("class", "x label")
      .attr("text-anchor", "middle")
      .attr("x", width/2)
      .attr("y", height - 30)
      .text("Years");

  chartArea4.append("text")
      .attr("class", "y label")
      .attr("text-anchor", "middle")
      .attr("y", -50)
      .attr("x", -200)
      .attr("dy", "0.75em")
      .attr("transform", "rotate(-90)")
      .text("Number of People");

  //creating bars
  var bar = chartArea4.selectAll("rect.bar")
           .data(data);

  bar.enter().append("rect").attr("class","bar")
            .attr("fill", "#FFC5D0")
            .attr("x", d => yearScale(d.year))
            .attr("y", d => countScale(d.totalcast))
            .attr("height", d => countScale(d.minority) - countScale(d.totalcast))
            .attr("width", yearScale.bandwidth());


  bar.enter().append("rect").attr("class","bar")
      .attr("fill", "#821D30")
      .attr("x", d => yearScale(d.year))
      .attr("y", d => countScale(d.minority))
      .attr("height", d => countScale(0) - countScale(d.minority))
      .attr("width", yearScale.bandwidth());


  //adding numbers to the bars
  data.forEach((d, i) => {

    svg4.append("text")
            .attr("text-anchor","hanging")
            .attr("font-size","15px")
            .attr("x",yearScale(d.year)+77)
            .attr('y',countScale(d.minority))
            .text(d.minority);
    svg4.append("text")
            .attr("text-anchor","hanging")
            .attr("font-weight", "bold")
            .attr("font-size","17px")
            .attr("x",yearScale(d.year)+77)
            .attr('y',countScale(d.totalcast))
            .text(d.white);

  });

  //creating legends
  const legend4 = chartArea4.append("g")
                  .attr("class", "legend")
                  .attr("transform","translate(10,10)");
  legend4.append("rect").attr("x", 20).attr("y", 10).attr("width", 230).attr("height", 70).attr("fill", "white").attr("stroke", "black");
  legend4.append("circle").attr("cx",40).attr("cy",30).attr("r", 8).style("fill", "#FFC5D0")
  legend4.append("circle").attr("cx",40).attr("cy",60).attr("r", 8).style("fill", "#821D30")
  legend4.append("text").attr("x", 60).attr("y", 30).text("Caucasian Contestants").style("font-size", "17px").attr("alignment-baseline","middle")
  legend4.append("text").attr("x", 60).attr("y", 60).text("Minority Constestans").style("font-size", "17px").attr("alignment-baseline","middle")


  //ending
  },

  //in case of error
  error => {console.log("error", error);
  });
  </script>


  <script>

  //creating a bar graph for MALE contestants for the bachelorette

  console.log( d3.csv("counted_data.csv") );

  //creating space for the other graph
  const svg3 = d3.select("svg#barchart");
  const width3 = svg3.attr("width");
  const height3 = svg3.attr("height");
  const margin3 = {top: 10, right: 10, bottom: 70, left: 50};
  const chartWidth3 = width3 - margin3.left - margin3.right;
  const chartHeight3 = height3 - margin3.top - margin3.bottom;

  let annotations3 = svg3.append("g").attr("id","annotations");
  let chartArea3 = svg3.append("g").attr("id","points")
                    .attr("transform",`translate(${margin3.left},${margin3.top})`);


  d3.csv("counted_data.csv").then( data => { console.log("data", data);

  //making sure each value is a number and not a string
  data.forEach((d, i) => {
    d['id'] = Number(d['id']);
    d['season'] = Number(d['season']);
    d['totalcast'] = Number(d['totalcast']);
    d['minority'] = Number(d['minority']);
    d['white'] = Number(d['white']);
    d['year'] = Number(d['year']);
  });
  console.log(data)

  //creating scales
  const leftScale = d3.scaleLinear().domain([0,45]).range([chartHeight, 0]);

  const years = d3.map(data, d => d.year)  // d3.map just runs a function on each item in an array
    console.log(years)
  const yearScale = d3.scaleBand().domain(years).range([0, chartWidth])
                           .padding(0.2);

  //axis and gridlines
  let leftAxis = d3.axisLeft(leftScale);
  let leftGridlines = d3.axisLeft(leftScale)
                           .tickSize(-chartWidth-10)
                           .tickFormat("")
  annotations3.append("g")
              .attr("class", "y axis")
              .attr("transform",`translate(${margin3.left-10},${margin3.top})`)
              .call(leftAxis)
  annotations3.append("g")
              .attr("class", "y gridlines")
              .attr("transform",`translate(${margin3.left-10},${margin3.top})`)
              .call(leftGridlines);
  let bottomAxis = d3.axisBottom(yearScale)

  annotations3.append("g")
              .attr("class", "x axis")
              .attr("transform",`translate(${margin3.left},${chartHeight+margin3.top+10})`)
              .call(bottomAxis);

  //axis labels
  chartArea3.append("text").attr("class", "x label")
        .attr("text-anchor", "middle")
        .attr("x", width/2)
        .attr("y", height - 30)
        .text("Years");

  chartArea3.append("text")
        .attr("class", "y label")
        .attr("text-anchor", "middle")
        .attr("y", -50)
        .attr("x", -200)
        .attr("dy", "0.75em")
        .attr("transform", "rotate(-90)")
        .text("Number of People");


  //creating bars
  var bar = chartArea3.selectAll("rect.bar")
           .data(data);

  bar.enter().append("rect").attr("class","bar")
            .attr("fill", "#B1D4E0")
            .attr("x", d => yearScale(d.year))
            .attr("y", d => leftScale(d.totalcast))
            .attr("height", d => leftScale(d.minority) - leftScale(d.totalcast))
            .attr("width", yearScale.bandwidth());


  bar.enter().append("rect").attr("class","bar")
      .attr("fill", "#0C2D48")
      .attr("x", d => yearScale(d.year))
      .attr("y", d => leftScale(d.minority))
      .attr("height", d => leftScale(0) - leftScale(d.minority))
      .attr("width", yearScale.bandwidth());

  //adding numbers to the bars
  data.forEach((d, i) => {

    svg3.append("text")
            .attr("text-anchor","hanging")
            .attr("font-size","15px")
            .attr("x",yearScale(d.year)+77)
            .attr('y',leftScale(d.minority))
            .text(d.minority);
    svg3.append("text")
            .attr("text-anchor","hanging")
            .attr("font-weight", "bold")
            .attr("font-size","17px")
            .attr("x",yearScale(d.year)+75)
            .attr('y',leftScale(d.totalcast))
            .text(d.totalcast);
  });

  //making legends
  const legend3 = chartArea3.append("g")
                .attr("class", "legend")
                .attr("transform","translate(10,10)");
  legend3.append("rect").attr("x", 20).attr("y", 10).attr("width", 230).attr("height", 70).attr("fill", "white").attr("stroke", "black");
  legend3.append("circle").attr("cx",40).attr("cy",30).attr("r", 6).style("fill", "#B1D4E0")
  legend3.append("circle").attr("cx",40).attr("cy",60).attr("r", 6).style("fill", "#0C2D48")
  legend3.append("text").attr("x", 60).attr("y", 30).text("Caucasian Contestants").style("font-size", "17px").attr("alignment-baseline","middle")
  legend3.append("text").attr("x", 60).attr("y", 60).text("Minority Constestans").style("font-size", "17px").attr("alignment-baseline","middle")

  //ending
  },

  //in case of error
  error => {console.log("error", error);
  });
  </script>

<div class = "projtitle"> <text class = "projtitle"> We found that while the number of minority contestants remains low, after a lawsuit in 2012, there was slighly more diversity on the shows. </text> </div>

  <div class = "graphtitle"> <text class = "graphtitle"> How long do minority contestants last? </text> </div>


  <svg id="batchelor" height="700" width="700" style="background: #FFFFFF;" ></svg>

  <script>
    d3.csv("Project-1-Dataset-Bachelor.csv", d3.autoType)
      .then((dataset)=>{

        const margin5 = { "top": 100, "right": 10, "bottom": 100, "left":100};
        const svg5 = d3.select("svg#batchelor");
        const width5 = svg.attr("width");
        const height5 = svg.attr("height");

        const chartWidth5 = width5 - margin5.left5 - margin5.right;
        const chartHeight5 = height5 - margin.top5 - margin5.bottom;
        console.log(dataset)
        seasonEx = d3.max(dataset, d => d["Season"])
        const seasonscale = d3.scaleLinear().domain([12, seasonEx]).range([chartHeight, 0]);
        elimEx = d3.max(dataset, d => d["ElimWeek"])
        const elimscale = d3.scaleLinear().domain([0, elimEx+1]).range([ 0, chartWidth]);

        x = dataset["ElimWeek"]
        y = dataset["Season"]

        let annotations5 = svg5.append("g").attr("id","annotations");

        let chartArea5 = svg5.append("g").attr("id","ElimWeek")
                .attr("transform","translate("+margin5.left+","+margin5.top+")");

        chartArea5.append("text")
        .attr("x", (width / 2)-50)
        .attr("y", -50)
        .attr("text-anchor", "middle")
        .style("font-size", "16px")
        .style("text-decoration", "underline")
        .text("When are Minorities Eliminated in the Bachelor");

        chartArea5.append("text")
        .attr("x", (width / 2)-50)
        .attr("y", chartHeight+50)
        .attr("text-anchor", "middle")
        .style("font-size", "16px")
        .text("Week Eliminated");


        chartArea5.append("text")
        .attr("x", -250)
        .attr("y", -50)
        .attr("transform", "rotate(-90)")
        .attr("text-anchor", "middle")
        .style("font-size", "16px")
        .text("Seasons");


        d3.select("#label").raise();

        let leftAxis = d3.axisLeft(seasonscale)
                          .tickFormat(d3.format(""))
        let leftGridlines = d3.axisLeft(seasonscale)
                              .tickSize(-chartWidth-10)
                              .tickFormat("")

        annotations5.append("g")
          .attr("class", "y axis")
          .attr("transform","translate("+(margin5.left-1)+"," + (margin5.top)+")")
          .call(leftAxis)

        annotations5.append("g")
          .attr("class", "y gridlines")
          .attr("transform","translate("+(margin5.left-1)+","+margin5.top+")")
          .call(leftGridlines);


        let bottomAxis = d3.axisBottom(elimscale)
                           .tickSize(5)
                           .ticks(12);

        let bottomGridlines = d3.axisBottom(elimscale).tickFormat("").tickSize(-chartHeight5-10)

        annotations5.append("g")
          .attr("class", "x axis")
          .attr("transform","translate("+margin5.left+","+(chartHeight+margin5.top)+")")
          .call(bottomAxis);

        let minoritydata = dataset.filter((d)=>{return (d["Minority"]=="M"&& d["ElimWeek"]!=null);});
        dataset.forEach((d, i) => {
          if(d["Minority"]=="M"&& d["ElimWeek"]==1 && d["Season"]==21){
            d["ElimWeek"]= 1+ Math.random()
          }
        });



        let circles = chartArea5.selectAll("circle.datapoint").data(minoritydata)
                                .join("circle")
                                .attr("cx", d=>elimscale(d["ElimWeek"]))
                                .attr("cy", d=>seasonscale(d['Season']))
                                .attr("r", 10)
                                .attr("opacity", .6)
                                .attr("fill", "#FB6090")

      });





  </script>



  <svg id="batchelorette" height="700" width="750" style="background: #FFFFFF;" >

  </svg>

  <script>
    d3.csv("Project-1-Dataset-Bachelorette.csv", d3.autoType)
      .then((dataset)=>{



        const margin6 = { "top": 100, "right": 10, "bottom": 100, "left":100};
        const svg6 = d3.select("svg#batchelorette");
        const width6 = svg6.attr("width");
        const height6 = svg6.attr("height");

        const chartWidth6 = width6 - margin6.left - margin6.right;
        const chartHeight6 = height6 - margin6.top - margin6.bottom;
        console.log(dataset)
        seasonEx = d3.max(dataset, d => d["Season"])
        const seasonscale = d3.scaleLinear().domain([4, seasonEx]).range([chartHeight, 0]);
        elimEx = d3.max(dataset, d => d["ElimWeek"])
        const elimscale = d3.scaleLinear().domain([0, elimEx+1]).range([ 0, chartWidth]);

        x = dataset["ElimWeek"]
        y = dataset["Season"]

        let annotations6 = svg6.append("g").attr("id","annotations");

        let chartArea6 = svg6.append("g").attr("id","ElimWeek")
                .attr("transform","translate("+margin6.left+","+margin6.top+")");

        chartArea6.append("text")
        .attr("x", (width / 2)-50)
        .attr("y", -50)
        .attr("text-anchor", "middle")
        .style("font-size", "16px")
        .style("text-decoration", "underline")
        .text("When are Minorities Eliminated in the Bachelorette");

        chartArea6.append("text")
        .attr("x", (width / 2)-50)
        .attr("y", chartHeight+50)
        .attr("text-anchor", "middle")
        .style("font-size", "16px")
        .text("Week Eliminated");


        chartArea6.append("text")
        .attr("x", -250)
        .attr("y", -50)
        .attr("transform", "rotate(-90)")
        .attr("text-anchor", "middle")
        .style("font-size", "16px")
        .text("Seasons");


        d3.select("#label").raise();

        let leftAxis = d3.axisLeft(seasonscale)
                          .tickFormat(d3.format(""))
        let leftGridlines = d3.axisLeft(seasonscale)
                              .tickSize(-chartWidth-10)
                              .tickFormat("")

        annotations6.append("g")
          .attr("class", "y axis")
          .attr("transform","translate("+(margin6.left-1)+"," + (margin6.top)+")")
          .call(leftAxis)

        annotations6.append("g")
          .attr("class", "y gridlines")
          .attr("transform","translate("+(margin6.left-1)+","+margin6.top+")")
          .call(leftGridlines);


        let bottomAxis = d3.axisBottom(elimscale)
                           .tickSize(5)
                           .ticks(12);

        let bottomGridlines = d3.axisBottom(elimscale).tickFormat("").tickSize(-chartHeight6-10)

        annotations6.append("g")
          .attr("class", "x axis")
          .attr("transform","translate("+margin6.left+","+(chartHeight+margin6.top)+")")
          .call(bottomAxis);

        let minoritydata = dataset.filter((d)=>{return (d["Minority"]=="M"&& d["ElimWeek"]!=null);});
        dataset.forEach((d, i) => {
          if(d["Minority"]=="M"&& (d["ElimWeek"]==1 && d["Season"]==16) || (d["ElimWeek"]==2 && d["Season"]==16)
              || (d["ElimWeek"]==7 && d["Season"]==16) || (d["ElimWeek"]==8 && d["Season"]==16)
              || (d["ElimWeek"]==1 && d["Season"]==15)|| (d["ElimWeek"]==1 && d["Season"]==14) || (d["ElimWeek"]==3 && d["Season"]==14)
              || (d["ElimWeek"]==4 && d["Season"]==14) || (d["ElimWeek"]==7 && d["Season"]==14)
              || ((d["ElimWeek"]==1 || d["ElimWeek"]==3 || d["ElimWeek"]==5 || d["ElimWeek"]==6) && d["Season"]==13)
              || ((d["ElimWeek"]==1 || d["ElimWeek"]==3) && d["Season"]==13)
              || ((d["ElimWeek"]==1 || d["ElimWeek"]==3) && d["Season"]==12)
              || ((d["ElimWeek"]==1 || d["ElimWeek"]==6) && d["Season"]==9))
              {
                d["ElimWeek"]= d["ElimWeek"] + Math.random()
              }
        });



        let circles = chartArea6.selectAll("circle.datapoint").data(minoritydata)
                                .join("circle")
                                .attr("cx", d=>elimscale(d["ElimWeek"]))
                                .attr("cy", d=>seasonscale(d['Season']))
                                .attr("r", 10)
                                .attr("opacity", .6)
                                .attr("fill", "#2E8BC0")

         let sym = d3.symbol().type(d3.symbolStar).size(500);
                              d3.select("svg6#batchelorette")
                                  .append("path")
                                  .attr("cx", d=>elimscale(d["ElimWeek"]))
                                  .attr("cy", d=>seasonscale(d['Season']))
                                  .attr("d", sym)
                                  .attr("fill", "red")
                                  .attr("transform", "translate(50, 50)");

      });





  </script>

<div class = "projtitle"> <text class = "projtitle"> Many minorities are eliminted early on in the show. In more recent season, however, there are more minorites represented and they tend to make it further.  </text> </div>


</body>
</html>
